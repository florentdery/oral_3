---
title: "Les vaches,<br>les amphibiens<br>et vous"
author: "Équipe 5 - Florent Déry, Morgane Le Goff, Myriam Trottier-Paquet"
date: "`r Sys.Date()`"
output:
  ioslides_presentation:
    widescreen: true
    smaller: true
editor_options: 
  chunk_output_type: console
---

<style>
pre {
    line-height: 1.2em;
    font-size: 10px;
}
</style>
## Contexte

Choix de projet = Effets des pâturages sur l'abondance et la diversité des amphibiens.

Invertebrés vs sensibilité / eutrophisation
Écrevisses vs sensibilité / eutrophisation
Poisson ?? 

## Objectif et question de recherche (étape 1)

Vérifier l'impact du pâturage par le bétail (vaches) sur les communautés d'amphibiens. 

## Hypothèses et prédictions (étape 2) | sous-titre
### sous titre ???

La présence et l'intensité d'M'utilisation du bétail modifient les conditions physico-chimiques des étangs, et ainsi l'abondance des invertébrés, poissons et écrevisses, ce qui détermine la composition des communautés amphibiennes. 


Prédictions: 
- Les conditions physico-chimiques sont différentes entre les étangs cloturés vs non-cloturés. 
  - Les vaches seront corrélées positivement aux nitrites
  - Les vaches seront corrélées positivement à la *temperature*?
  - Les vaches seront corrélées positivement à la conductivité
  - Les vaches seront corrélées négativement au pH
  - Les vaches seront corrélées négativement à l'O^2

## Variables du système (étape 3)

- Modèle conceptuel?
Voici le jeu de données : 

```{r load_dat, echo=F, warnings=F, message=F}
require(tidyverse)
dat=read.delim("data/jeu_ecologique.txt") %>% 
  mutate(etang=as.factor(as.character(etang)),
         cloture=factor(cloture)) %>% 
  rename(vache_std=vache) %>% 
  arrange(aire) 

glimpse(dat)
summary(dat)

```

## Rôle, type et distribution des variables (étape 4)
Jettons un coup d'oeil premièrement à la variable dépendante, représentée par une matrice d'abondance de la communauté amphibienne. Les colonnes représentent les espèces, et les lignes représentent les sites. 

```{r step_4_quick_look_to_Ys, echo=T, warnings=F, message=F}
amphi<-dat %>% 
  select(etang,A_Gr:N_Vi) %>% 
  column_to_rownames("etang")
# Étendue
range(amphi)
# Nombre de zéros, puis proportion de zéros dans la communauté
sum(amphi==0) ; sum(amphi==0)/(nrow(amphi)*ncol(amphi))
```
Les valeurs d'abondance relative sont entre 0 et 0.86. 
Les zéros (absences) composent 70.5% de la matrice. Les données d'abondance ont été standardisées par unité d'effort et par abondance totale pour chaque espèce. 

## Étape 4 - distribution des Ys
```{r distribution_ys,  echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(10,4.3) }
amphi %>% 
  pivot_longer(1:9,names_to = "espece", values_to = "prop") %>% 
  mutate(lng_nm=case_when(espece=="A_Gr"~ "Acris gryllus",
                          espece=="G_Ca"~ "Gastrophryne carolinensis",
                          espece=="S_La"~ "Siren lacertina",
                          espece=="H_Ci"~ "Hyla cinerea",
                          espece=="H_Fe"~ "Hyla Femoralis",
                          espece=="H_Sq"~ "Hyla squirella",
                          espece=="L_Gr"~ "Lithobates grylio",
                          espece=="L_Sp"~ "Lithobates sphenocephalus",
                          espece=="N_Vi"~ "Notophthalmus viridescens")) %>% 
ggplot(aes(prop))+
  geom_histogram()+
  geom_density()+
  facet_wrap(~lng_nm, scales="free_y")+
  theme_bw()
```

## Étape 4 - Variables indépendantes X
La variable indépendante "cloture" est une variable catégorique à 2 facteurs (Yes, No). 
La variable "Intensité d'utilisation de l'étang par le bétail" est une variable numérique continue dont la distribution [min ; max = 0 ; 0.6] est biaisée à gauche. 

```{r distribution_xs,  echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(10,4) }
p1= ggplot(dat, aes(cloture, fill=cloture))+
  geom_bar()+
  xlab("Étang clôturé ou non?")+
  ylab("Nombre d'étangs")+
  scale_fill_manual(values=c("steelblue4", "darkgoldenrod2"))+
  theme_bw()

p2=ggplot(dat, aes(vache_std))+  
geom_histogram(aes(fill=cloture))+
  geom_density()+
  xlab("Nombre de fèces standardisé")+
  ylab("Nombre d'étangs")+
  scale_fill_manual(values=c("steelblue4", "darkgoldenrod2"))+
  theme_bw()+
  theme(legend.position = c(0.8, 0.8))

require(patchwork)

p1 + p2 + plot_layout(ncol=2, widths=c(0.33, .67))
```
5 étangs sont clôturés, 35 étangs ne l'étaient pas. Parmi les étangs non-cloturés, 3 étangs ne semblent pas avoir été utilisés par les vaches (pas de fèces)

## Étape 4 - Covariables | Caractéristiques physico-chimiques -> non-standardisées
- Conductivité: numérique continue, distribution normale
- Nitrates: numérique continue, distribution déviée à gauche
- Température (Celcius): numérique continue, distribution déviée à gauche
  - Quelques valeurs extrèmes

```{r distribution_covariables_chim_a,  echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(8,4) }
par(mfrow=c(1,3))
hist(dat$conductivite,
     main="Conductivité",
     xlab="Conductivité",
     col="cornflowerblue")
hist(dat$nitrates,
     main="Nitrates",
     xlab="Nitrates",
     col="cornflowerblue")
hist(dat$temperature,
     main="Température",
     xlab="Température en degré C",
     col="cornflowerblue")
range(dat$pH)
```
## Étape 4 - Covariables | Caractéristiques physico-chimiques

- Oxygène: numérique continue, distribution normale
  - Il y a des valeurs négatives!!!  
- pH: numérique continue, distribution déviée à gauche
  - Des étangs sont plus acides que du jus de citron, et presqu'aussi basiques que de l'eau de Javel! 
```{r distribution_covariables_chim_b,  echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(10,4.3) }
par(mfrow=c(1,2))
hist(dat$oxygene,
     main="Oxygène",
     xlab="Oxygène dissous",
     col="cornflowerblue")
hist(dat$pH,
     main="pH",
     xlab="pH",
     col="cornflowerblue")
```

## Étape 4 - Covariables | Caractéristiques topographiques
- Profondeur (cm): numérique continue, distribution normale
- Aire (m^2): numérique continue, distribution *relativement* normale

```{r distribution_covariables_topo,  echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(10,4.3) }
par(mfrow=c(1,2))
hist(dat$profondeur,
     main="Profondeur",
     xlab="Profondeur en cm",
     col="cornflowerblue")
hist(dat$aire,
     main="Aire",
     xlab="Aire en m^2",
     col="cornflowerblue")
```

## Étape 4 - Covariables | Facteurs biotiques

- Invertébrés: numérique continue, distribution déviée à gauche
- Écrevisses: numérique continue, distribution déviée à gauche avec beaucoup de zéros
- Poissons: numérique continue, distribution avec beaucoup de zéros

```{r distribution_covariables_biotiques,  echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(8,4) }
par(mfrow=c(1,3))
hist(dat$invertebres,
     main="Invertébrés",
     xlab="Abondance d'invertébrés prédateurs",
     ylab="Nombre d'étangs",
     col="cornflowerblue")
hist(dat$ecrevisses,
     main="Écrevisses",
     xlab="Abondance d'écrevisses",
     ylab="Nombre d'étangs",
     col="cornflowerblue")
hist(dat$poissons,
     main="Poissons",
     xlab="Abondance de poissons",
     ylab="Nombre d'étangs",
     col="cornflowerblue")

```


## Interactions potentielles à tester (étape 5)

Aucune. La question initiale parle plus d'objectifs specifiques en termes d'effets fixes (Clôturé. vs pas Clôturé, ou encore l'effet de l'intensité d'utilisation des vaches). On pose des questions en termes d'effets seuls - pas en interaction. On demande toutefois de prendre en compte les caractéristiques physico-chimiques et biotiques (en tant que covariables).  

```{r boff_interaction, echo = F}
# dat %>% 
#   mutate(prof_cat=factor(
#     case_when(
#       profondeur < 181 ~ "very_shallow", 
#       profondeur %in% c(181:242)~ "shallow",
#       profondeur %in% c(243:330)~ "medium",
#       profondeur %in% c(331:460)~ "deep",
#       profondeur > 460 ~ "very_deep"    
#     ), levels= c("very_shallow", 
#                  "shallow",
#                  "medium",
#                  "deep",
#                  "very_deep")))%>% 
#   pivot_longer(A_Gr:N_Vi, names_to = "espece", values_to = "prop") %>% 
#   pivot_longer(conductivite:pH, names_to = "parametre", values_to = "mesure") %>% 
#   ggplot()+
#   geom_point(aes(x= mesure, y= prop, color=espece)) +
#   facet_grid(vars(cloture), vars(prof_cat), scales= "free_x", space="free_x")+
#   ylab("Proportion par site")+
#   xlab("Mesure du paramètre")
```

## Exploration des données (étape 6)

## 6.1 - Données aberrantes en X 
- Les valeurs de vache_std sont entre 0 et 0.575
- Il ne semble pas y avoir de données aberrantes, mais 3 étangs non-clôturés ne semblent pas avoir été visités par les vaches. 

```{r abberent_Xs_vache, echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(8,4) }
range(dat$vache_std) 
p3=ggplot(dat)+
  geom_histogram(aes(vache_std))+
  xlab("")+
  ylab("Fréquence")+
    theme_bw()
p4=ggplot(dat)+
  geom_point(aes(y=rownames(dat), x=vache_std))+
  xlab("")+
  ylab("Index (No de ligne)")+
    theme_bw()
p5=ggplot(dat)+
  geom_boxplot(aes(x=vache_std))+
  xlab("")+
  ylab("")+
  theme_bw()+
  theme(axis.line.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())
require(cowplot)
p6=plot_grid(p3,p5, nrow=2, rel_heights = c(3.5, 1))
plot_grid(p6,p4, ncol=2)+
  labs(caption="Nombre de fèces standardisé")
```

## 6.1 - Données aberrantes en X 
- O2: Il y a des valeurs négatives!!!  
- pH: Des étangs sont plus acides que du jus de citron, et presqu'aussi basiques que de l'eau de Javel! 

```{r abberent_Xs_physico, echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(8,4) }
Chimie<-dat[ , c(5:9)]
l1 <- function() {
  par(
    mar=c(1,1,1,1),
    mfrow=c(1,5)
  )
for(i in 1:ncol(Chimie)) {
  hist(Chimie[,i], main=names(Chimie)[i], breaks=30)
}
}

l2 <- function() {
  par(
    mar=c(1,1,1,1),
    mfrow=c(1,5)
  )
  for(i in 1:ncol(Chimie)) {
    boxplot(Chimie[,i],horizontal = T, main=NULL)
  }
}
library(gridGraphics); library(cowplot)
plot_grid(ggdraw(l1) , ggdraw(l2), ncol=1, rel_heights = c(.8, .2))

```

## 6.1 - Données aberrantes en X 

Il ne semble pas particulièrement y avoir de données aberrantes en ce qui concerne la topographie des étangs

```{r aberrant_Xs_topo, echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(8,4) }
Top<-dat[ , c(4, 10)]

l1=function()  {
  par(
  mfrow=c(1,2),
    mar=c(1,1,1,1)
  )
for(i in 1:ncol(Top)) {
  hist(Top[,i], main=names(Top)[i], breaks=30)
}
}
l2=function()  {
  par(
  mfrow=c(1,2),
    mar=c(1,1,1,1)
  )
for(i in 1:ncol(Top)) {
  boxplot(Top[,i], main=NULL, horizontal=T)
}
}

plot_grid(ggdraw(l1) , ggdraw(l2), ncol=1, rel_heights = c(.8, .2))
```

## 6.1 - Données aberrantes en X 

En ce qui concerne les poissons et les écrevisses, i8l semble y avoir beaucoup de zéros. Il faudra peut-être transformer (e.g. log) les variables poissons et écrevisses. Les écrevisses étant des prédateurs des grenouilles (tétards), on pourrait peut-être travailler en absence-présence d'écrevisses dans nos analyses, si cette variable est problématique.  

```{r aberrant_Xs_biotiques, echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(8,4) }
living<-dat[ , c("invertebres", "poissons", "ecrevisses")]

l1=function () {
par(
  mfrow=c(1,3),
    mar=c(1,1,1,1)
  )
for(i in 1:ncol(living)) {
  hist(living[,i], main=names(living)[i], breaks=30)
} 
}


l2=function () {
par(
  mfrow=c(1,3),
    mar=c(1,1,1,1)
  )
for(i in 1:ncol(living)) {
  boxplot(living[,i], main=NULL, horizontal=T)
}
}

plot_grid(ggdraw(l1) , ggdraw(l2), ncol=1, rel_heights = c(.8, .2))
```

## 6.1 - Données aberrantes en Y

On a déjà jetté un coup d'oeil à la distribution des abondances relatives d'amphibien à l'étape 4. Le voici en rappel avec des boxplots. 

```{r aberrant_Ys, echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(10,5) }
amphi<-dat %>% 
  select(etang,A_Gr:N_Vi) %>% 
  column_to_rownames("etang") 


l1=function () {
par(
  mfrow=c(1,3),
    mar=c(1,1,1,1)
  )
for(i in 1:3) {
  hist(amphi[,i], main=names(amphi)[i], breaks=30)
}
}

l2=function () {
par(
  mfrow=c(1,3),
    mar=c(2,1,1,1)
  )
for(i in 1:3) {
  boxplot(amphi[,i], main=NULL, horizontal=T)
}
}

line1=plot_grid(ggdraw(l1) , ggdraw(l2), ncol=1, rel_heights = c(.7 , .3))
l3=function () {
par(
  mfrow=c(1,3),
    mar=c(1,1,1,1)
  )
for(i in 4:6) {
  hist(amphi[,i], main=names(amphi)[i], breaks=30)
}
}

l4=function () {
par(
  mfrow=c(1,3),
    mar=c(2,1,1,1)
  )
for(i in 4:6) {
  boxplot(amphi[,i], main=NULL, horizontal=T)
}
}

line2=plot_grid(ggdraw(l3) , ggdraw(l4), ncol=1, rel_heights = c(.7 , .3))

l5=function () {
par(
  mfrow=c(1,3),
    mar=c(1,1,1,1)
  )
for(i in 7:9) {
  hist(amphi[,i], main=names(amphi)[i], breaks=30)
}
}

l6=function () {
par(
  mfrow=c(1,3),
    mar=c(2,1,1,1)
  )
for(i in 7:9) {
  boxplot(amphi[,i], main=NULL, horizontal=T)
}
}

line3=plot_grid(ggdraw(l5) , ggdraw(l6), ncol=1, rel_heights = c(.7 , .3))
plot_grid(line1, 
          line2,
          line3, ncol=1)

rm(l1,l2, l3, l4, l5,l6,
   line1, 
   line2, 
   line3)

```

## 6.1 - Données aberrantes en Y

On peut toutefois inspecter le compte d'espèces à chaque site (convertir les abondances relatives en 0-1 pour chaque site). On peut aussi jetter un coup d'oeil à la richesse spécifique. 

```{r amphi_barplot, echo=F, warnings=F, message=F, fig.align="center", fig.dim=c(8,3)}
amphi<-dat %>% 
  select(etang,A_Gr:N_Vi) %>% 
  column_to_rownames("etang") %>% 
  vegan::decostand(amphi, method = "pa") 

tmp=table(rowSums(amphi)) %>%
data.frame()
colnames(tmp) =  c("especes_presentes", "nombre_de_sites")

plot_grid(
  ggplot()+
    geom_col(aes(y=sort(colSums(amphi)),
                 x=factor(names(sort(colSums(amphi))), 
                          levels=names(sort(colSums(amphi))))
    )
    )+ 
    xlab("Espèce")+
    ylab("Nombre de présences\n(tous les sites confondus)")+
    theme_classic(),
  

  ggplot(tmp)+
    geom_col(aes(especes_presentes,nombre_de_sites))+
    xlab("Richesse spécifique à chaque site")+
    scale_y_continuous("Nombre de sites", 
                       breaks=seq(0, 12, 2), 
                       limits=c(0,12.1))+
    theme_classic()
)

```

## 6.2 - Homogénéité de la variance et normalité des Ys

Dans notre cas, on ne s'attend pas à ce que la variance des Ys soit homogène (on ne fait pas des modèles linéaires où les résidus devraient être homogènes, etc.); qui plus est, ce n'est pas une supposition à respecter dans le cadre d'une analyse multivariée...

Dans notre cas, on ne s'attend pas à ce que la variance des Ys soit Normale non plus. 

## 6.4 - Problèmes de 0 dans les Y

Comme on a vu plus tôt à l'étape 4 les zéros (absences) composent 70.5% de la matrice. Il se pourrait d'ailleurs que la faible présence de certaines espèces (H_Fe, N_Vi et A_GR) pose des problèmes pour l'analyse visée. 


## 6.5 - Collinéarité des X
Premièrement avec les étangs non cloturés: 
```{r, echo=F, message=F, warnings=F, fig.width=10, fig.height=5.3}
dat %>% 
  subset(cloture=="No" & vache_std>0) %>% 
  select(vache_std:poissons) %>%
  relocate(aire, .after = profondeur) %>% 
  psych::pairs.panels()

```

## 6.5 - Collinéarité des X
Maintenant avec les étangs non cloturés, sans la variables vache.
```{r, echo=F, message=F, warnings=F, fig.width=10, fig.height=5.3}
dat %>% 
    subset(cloture=="Yes" | vache_std==0) %>% 
  select(profondeur:poissons) %>%
  relocate(aire, .after = profondeur) %>% 
  psych::pairs.panels()

dat %>% 
    # subset(cloture=="Yes" | vache_std==0) %>% 
  select(vache_std:poissons) %>%
  relocate(aire, .after = profondeur) %>% 
  psych::pairs.panels()

```


## 6.5 - Collinéarité des X
Variable cloture vs. variables *physico-chimiques*

```{r, echo=F, message=F, warnings=F, fig.width=7, fig.height=4.3, fig.align="center"}
dat %>% 
  select(cloture, conductivite:pH) %>% 
  pivot_longer(conductivite:pH, names_to = "parametre", values_to = "mesure") %>% 
  ggplot(aes(y= mesure, x=cloture )) +
  geom_boxplot(outlier.shape = NA)+
  geom_jitter(height=0, width=.1)+
  facet_wrap(~parametre, scales = "free_y")+
  theme_bw()

```

## 6.5 - Collinéarité des X
Variable cloture vs. variables *topographiques*

```{r, echo=F, message=F, warnings=F, fig.width=7, fig.height=4.3, fig.align="center"}
dat %>% 
  select(cloture, profondeur, aire) %>% 
  pivot_longer(profondeur:aire, names_to = "caracteristique", values_to = "mesure") %>% 
  ggplot(aes(y= mesure, x=cloture )) +
  geom_boxplot(outlier.shape = NA)+
  geom_jitter(height=0, width=.1)+
  facet_wrap(~caracteristique, scales = "free_y")+
  theme_bw()

```

## 6.5 - Collinéarité des X
Variable clôture vs. variables *biotiques*

```{r, echo=F, message=F, warnings=F, fig.width=7, fig.height=4.3, fig.align="center"}
dat %>% 
  select(cloture, invertebres:poissons) %>% 
  pivot_longer(invertebres:poissons, names_to = "taxon", values_to = "compte") %>% 
  ggplot(aes(y= compte, x=cloture )) +
  geom_boxplot(outlier.shape = NA)+
  geom_jitter(height=0, width=.1)+
  facet_wrap(~taxon, scales = "free_y")+
  theme_bw()

```

## 6.6 - Liens X et Y
Abondances relatives en fonction des paramètres physico-chimiques
```{r, echo=F, message=F, warnings=F, fig.width=7, fig.height=4.3, fig.align="center"}

pal=paletteer::paletteer_d("colorBlindness::paletteMartin") %>%  sample(9)

dat%>% 
  pivot_longer(A_Gr:N_Vi, names_to = "espece", values_to = "prop") %>% 
  pivot_longer(conductivite:pH, names_to = "parametre", values_to = "mesure") %>% 
  ggplot(aes(x= mesure, y= prop))+
  geom_point(aes(color=espece), size=2) +
    geom_smooth()+
   scale_color_manual(values=pal)+
 facet_wrap(~parametre, scales= "free_x")+
  ylab("Proportion par site")+
  xlab("Mesure du paramètre")+
  theme_bw()


 # %>% 
 #  mutate(prof_cat=factor(
 #    case_when(
 #      profondeur < 181 ~ "very_shallow", 
 #      profondeur %in% c(181:242)~ "shallow",
 #      profondeur %in% c(243:330)~ "medium",
 #      profondeur %in% c(331:460)~ "deep",
 #      profondeur > 460 ~ "very_deep"    
 #    ), levels= c("very_shallow", 
 #                 "shallow",
 #                 "medium",
 #                 "deep",
 #                 "very_deep")))
```

## 6.6 - Liens X et Y
Abondances relatives en fonction des caractéristiques topographiques

```{r, echo=F, message=F, warnings=F, fig.width=7, fig.height=4.3, fig.align="center"}

dat%>% 
  pivot_longer(A_Gr:N_Vi, names_to = "espece", values_to = "prop") %>% 
  select(prop, profondeur, aire, espece) %>% 
  pivot_longer(profondeur:aire, names_to = "caracteristique", values_to = "mesure") %>% 
  ggplot(aes(x= mesure, y= prop))+
  geom_point(aes(color=espece), size=2) +
    geom_smooth()+
   scale_color_manual(values=pal)+
 facet_wrap(~caracteristique, scales= "free_x")+
  ylab("Proportion par site")+
  xlab("Mesure du paramètre")+
  theme_bw()

```

## 6.6 - Liens X et Y
Abondances relatives en fonction des facteurs biotiques

```{r, echo=F, message=F, warnings=F, fig.width=10, fig.height=4.3, fig.align="center"}
dat%>% 
  pivot_longer(A_Gr:N_Vi, names_to = "espece", values_to = "prop") %>% 
  pivot_longer(invertebres:poissons, names_to = "facteur_biotique", values_to = "compte") %>% 
  ggplot(aes(x= compte, y= prop))+
  geom_point(aes(color=espece), size=2) +
    geom_smooth()+
   scale_color_manual(values=pal)+
 facet_wrap(~facteur_biotique, scales= "free_x")+
  ylab("Proportion par site")+
  xlab("Mesure du paramètre")+
  theme_bw()

```

## 6.6 - Liens X et Y
Abondances relatives en fonction de l'intensité des vaches et de la présence de cloture

```{r, echo=F, message=F, warnings=F, fig.width=10, fig.height=4.3, fig.align="center"}
p1=dat%>% 
  pivot_longer(A_Gr:N_Vi, names_to = "espece", values_to = "prop") %>% 
  ggplot(aes(x= cloture, y= prop))+
  geom_boxplot(outlier.shape = NA)+
  geom_jitter(aes(color=espece),height=0, width=.1)+
   scale_color_manual(values=pal)+
  ylab("Proportion par site")+
  xlab("Cloturé?")+
  theme_bw()+
  theme(legend.position = "none")

p2= dat%>% 
  pivot_longer(A_Gr:N_Vi, names_to = "espece", values_to = "prop") %>% 
  ggplot(aes(x= vache_std, y= prop))+
  geom_point(aes(color=espece), size=2) +
    geom_smooth()+
   scale_color_manual(values=pal)+
  ylab("Proportion par site")+
  xlab("Intensité d'utilisation par les vaches")+
  theme_bw()

require(patchwork)
p1+p2+plot_layout(ncol=2, guides = "collect")
```

## 6.7 - Indépendance des Y

Richesse spécifique nombre d'espèces en fonction des sites
```{r}

# 70% zeros

# spe.relf <- 100*spe.pres/nrow(dat2)
# # Round the sorted output to 1 digit
# round(sort(spe.relf), 1)
# 
# 
# par(mfrow=c(1,2))
# # 3 espèces sont présentes dans 0 à 5 sites
# hist(spe.pres, main="Species Occurrences", right=FALSE, las=1, 
#     xlab="Number of occurrences", ylab="Number of species", 
#     breaks=seq(0,30,by=5), col="bisque") 
# # 3 espèces sont présentes dans 0 à 5 sites ^^ (p. ex)
# hist(spe.relf, main="Species Relative Frequencies", right=FALSE, las=1,
#     xlab="Frequency of occurrences (%)", ylab="Number of species",
#         breaks=seq(0, 100, by=5), col="bisque")
# 
# # To sum by rows, the second argument of apply(), MARGIN, is set to 1
# sit.pres <- apply(dat2> 0, 1, sum)
# # Sort the results in increasing order
# sort(sit.pres)
```


```{r, echo=F, message=F, warnings=F, fig.width=10, fig.height=4.3, fig.align="center"}
# Plot species richness vs. site
# dat2=dat %>% 
#   select(A_Gr:N_Vi)
# rownames(dat2) <- dat2$etang
# 
# spe.pres <- apply(dat2 > 0, 2, sum)
# 
# plot(spe.pres,type="s", las=1, col="gray",
#     main="Richesse spécifique par site",
#     xlab="Site", ylab="Richesse Spécifique")
# text(jitter(sit.pres, factor=1, amount=.1), row.names(dat2), cex=.8, col="red")
# 

```


## 6.8 - Collinéarité des Y

```{r, echo=F, message=F, warnings=F, fig.width=10, fig.height=4.3, fig.align="center"}
dat%>% 
  select(A_Gr:N_Vi) %>% 
  psych::pairs.panels()
```

## Choix de l'analyse (étape 7)

## Exécuter l'analyse (étape 8)
```{r}






```

## Choix de l'analyse (étape 7)

## Exécuter l'analyse (étape 8)